<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>RVTools - Pentester, wtf!?</title><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="RVTools"><meta property="og:description" content="Hardcoded encryption keys in sysadmin tools"><meta property="og:type" content="article"><meta property="og:url" content="/blog/lol-rvtools/"><meta property="article:published_time" content="2019-08-04T18:00:00+10:00"><meta property="article:modified_time" content="2019-08-04T18:00:00+10:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="RVTools"><meta name=twitter:description content="Hardcoded encryption keys in sysadmin tools"><link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:500,100,300" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=/css/normalize.css><link rel=stylesheet type=text/css media=screen href=/css/main.css></head><body><div class="container wrapper post"><div class=header><a href=/><img src=/images/header.png alt="Break things, write reports"></a><div class=site-description></div><nav class=nav><ul class=flat></ul></nav></div><div class=post-header><h1 class=title>RVTools</h1><div class=meta>Posted at &mdash; Aug 4, 2019</div></div><div class=markdown><h2 id=tldr>Tl;dr</h2><p>_RVToolsPWD is a clearly reverseable password blob, PBKDF2 used on <code>robware</code> and <code>Ivan Medvedev</code></p><h2 id=what>What</h2><p>If you see this <code>_RVToolsPWD</code> preamble in a string, and if it also looks like Base64, it&rsquo;s probably this.</p><ul><li>rvtools <a href=https://www.robware.net/rvtools/>https://www.robware.net/rvtools/</a></li><li>This thing logs into a a bunch of VMWare boxes and pulls stats</li><li>Apparently this tool is popular, as it&rsquo;s mentioned on some podcast as the Number 1 tool <a href=https://blogs.vmware.com/virtualblocks/2019/03/08/vspeaking-podcast-episode-108-top-10-vmware-tools/>https://blogs.vmware.com/virtualblocks/2019/03/08/vspeaking-podcast-episode-108-top-10-vmware-tools/</a><ul><li>Also lets you update VMWare tools</li></ul></li><li>It includes a handy password &lsquo;encryption&rsquo; utility, which can be used to presumably keep the GRC nerds at bay</li></ul><p>To no ones surprise, it&rsquo;s encryption is pretty silly, as it&rsquo;s got a hardcoded password and salt. Further, to no ones surprise, the account that&rsquo;d have it&rsquo;s credentials &lsquo;encrypted&rsquo; probably has more rights than it needs, so if one was to find this tool in the wild, decrypt the credentials and you&rsquo;re probably going to have crazy rights on your targets VMware clusters.</p><p>The relevant code is below:</p><pre><code>// RVToolsPasswordEncryption.FMain
using System;
using System.IO;
using System.Security.Cryptography;
using System.Text;
 
private void buttonEncrypt_Click(object sender, EventArgs e)
{
    if (txtPassword.TextLength != 0)
    {
        string password = &quot;robware&quot;;
        byte[] bytes = Encoding.Unicode.GetBytes(txtPassword.Text);
        using (Aes aes = Aes.Create())
        {
            Rfc2898DeriveBytes rfc2898DeriveBytes = new Rfc2898DeriveBytes(password, new byte[13]
            {
                73,
                118,
                97,
                110,
                32,
                77,
                101,
                100,
                118,
                101,
                100,
                101,
                118
            });
            aes.Key = rfc2898DeriveBytes.GetBytes(32);
            aes.IV = rfc2898DeriveBytes.GetBytes(16);
            using (MemoryStream memoryStream = new MemoryStream())
            {
                using (CryptoStream cryptoStream = new CryptoStream(memoryStream, aes.CreateEncryptor(), CryptoStreamMode.Write))
                {
                    cryptoStream.Write(bytes, 0, bytes.Length);
                    cryptoStream.Close();
                }
                txtEncryptedPassword.Text = &quot;_RVToolsPWD&quot; + Convert.ToBase64String(memoryStream.ToArray());
            }
        }
    }
}
</code></pre><p>Also, the salt appears to decode to <code>Ivan Medvedev</code> - which makes one wonder if the code was just copy-pasted off a github gist somewhere. It probably isn&rsquo;t the actual <a href=https://www.linkedin.com/in/ivanmed>https://www.linkedin.com/in/ivanmed</a></p></div></div><div class="footer wrapper"><nav class=nav><div></div></nav></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-141761824-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>