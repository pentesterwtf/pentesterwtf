<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Misc things from 2020 - Pentester, wtf!?</title><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="Misc things from 2020"><meta property="og:description" content="A bunch of things that were noteworthy from 2020 that might have been missed"><meta property="og:type" content="article"><meta property="og:url" content="/blog/2020-misc/"><meta property="article:published_time" content="2021-01-13T18:00:00+10:00"><meta property="article:modified_time" content="2021-01-13T18:00:00+10:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Misc things from 2020"><meta name=twitter:description content="A bunch of things that were noteworthy from 2020 that might have been missed"><link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:500,100,300" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=/css/normalize.css><link rel=stylesheet type=text/css media=screen href=/css/main.css></head><body><div class="container wrapper post"><div class=header><a href=/><img src=/images/header.png alt="Break things, write reports"></a><div class=site-description></div><nav class=nav><ul class=flat></ul></nav></div><div class=post-header><h1 class=title>Misc things from 2020</h1><div class=meta>Posted at &mdash; Jan 13, 2021</div></div><div class=markdown><p>I&rsquo;m doing this because i&rsquo;ve got too many Trello tickets with little interesting tidbits in them, which sound like something worth sharing.</p><h2 id=uuids-generally-do-not-meet-security-requirements>&ldquo;UUIDS GENERALLY DO NOT MEET SECURITY REQUIREMENTS&rdquo;</h2><p>Thanks to littlemaninmyhead, which can be found at <a href=https://littlemaninmyhead.wordpress.com/2015/11/22/cautionary-note-uuids-should-generally-not-be-used-for-authentication-tokens/>https://littlemaninmyhead.wordpress.com/2015/11/22/cautionary-note-uuids-should-generally-not-be-used-for-authentication-tokens/</a></p><p>Summarised as &ldquo;Do not assume that UUIDs are hard to guess; they should not be used as security capabilities (identifiers whose mere possession grants access), for example.&rdquo;</p><h2 id=assetnote-wordlists>Assetnote wordlists</h2><p><a href=https://wordlists.assetnote.io/>https://wordlists.assetnote.io/</a></p><p>Assetnote published some wordlists, they&rsquo;re pretty good, go check them out. They&rsquo;re meant to be automatically generated, which seems to be failing since December last year (<a href="https://github.com/assetnote/wordlists/runs/1617218746?check_suite_focus=true">https://github.com/assetnote/wordlists/runs/1617218746?check_suite_focus=true</a>)</p><h2 id=vxunderground>VXUnderground</h2><p><a href=https://github.com/vxunderground/MalwareSourceCode>https://github.com/vxunderground/MalwareSourceCode</a></p><p>I&rsquo;m unsure when these guys came to play, but they&rsquo;ve been putting up source code for some fairly high profile implants. Curiously, they dump anything &lsquo;APT&rsquo; too, which might be of interest if you&rsquo;re looking to make some better tooling.</p><h2 id=gps-issues>GPS issues</h2><p><a href=https://www.jpost.com/breaking-news/gps-glitches-overwhelm-phones-in-tehran-653667>https://www.jpost.com/breaking-news/gps-glitches-overwhelm-phones-in-tehran-653667</a></p><p>More instances of GPS being &lsquo;glitchy&rsquo; are becoming more common.</p><p>ZXSecurity did a cool talk on what would be illegal, but also what could go wrong if someone was tampering with RF: <a href=https://paper.seebug.org/papers/Security%20Conf/Defcon/2017/DEFCON-25-Karit-ZX-Security-Using-GPS-Spoofing-To-Control-Time.pdf>https://paper.seebug.org/papers/Security%20Conf/Defcon/2017/DEFCON-25-Karit-ZX-Security-Using-GPS-Spoofing-To-Control-Time.pdf</a></p><h2 id=samesite-cookies-lax-by-default>Samesite cookies lax by default</h2><p>Chrome changed to automatically treat all cookies as samesite lax, making CSRF attacks seem a thing of the past. This happened back in Feburary 2020, nothing major seemed to break - perhaps this is another successful case of removing an entire bug class.</p><p>Curious to see if Pentesting shops stop reporting CSRF now? However:</p><ul><li>Google initially published this at <a href=https://blog.chromium.org/2020/02/samesite-cookie-changes-in-february.html>https://blog.chromium.org/2020/02/samesite-cookie-changes-in-february.html</a></li><li>Firefox apparently had samesite lax in nightly since feburary 2020, <a href=https://hacks.mozilla.org/2020/08/changes-to-samesite-cookie-behavior/>https://hacks.mozilla.org/2020/08/changes-to-samesite-cookie-behavior/</a><ul><li>They seemingly made it default in August 2020</li></ul></li><li>Edge would be fine, because Chromium upstream</li><li>I can&rsquo;t see if IE11 defaults to same site lax</li><li>Safari apparently has some issues</li><li>I don&rsquo;t really care about brave/whatever browsers</li></ul><p>So CSRF isn&rsquo;t <em>dead</em> but only because people are still using old or stupid (Safari) browsers.</p><h2 id=flash-dies>Flash dies</h2><p>Everyone knows, I&rsquo;m sure it&rsquo;s still used in critical places.</p><p>Unfortunately, Silverlight is still around until 2021 - <a href=https://support.microsoft.com/en-us/windows/silverlight-end-of-support-0a3be3c7-bead-e203-2dfd-74f0a64f1788>https://support.microsoft.com/en-us/windows/silverlight-end-of-support-0a3be3c7-bead-e203-2dfd-74f0a64f1788</a></p><h2 id=stress-testing-c2>Stress testing C2</h2><p>Although not in 2020, a talk seemed to go by mostly unnoticed - where an RSA guy fiddles with outbound comms to command and control, resulting in crashes, weird behaviour, or just pissing off operators significantly. A lot more work could be done here, albeit it depends on the successful identification and reverse engineering of communications.</p><p><a href="https://www.youtube.com/watch?v=Z1-4-amGdaM&feature=youtu.be">https://www.youtube.com/watch?v=Z1-4-amGdaM&feature=youtu.be</a></p><h2 id=domain-fronting>Domain fronting</h2><p>Still works.</p><h2 id=shandyman-tracelabs-ctf>Shandyman Tracelabs CTF</h2><p>A reputable team does a writeup, mostly coming down to communicating with your team rather than fancy tools.</p><p><a href=https://www.tracelabs.org/blog/shandy-perspective>https://www.tracelabs.org/blog/shandy-perspective</a></p><h2 id=hashing-tls-responses-jarm>Hashing TLS responses (JARM)</h2><p>The creators of JA3 (<a href=https://github.com/salesforce/ja3>https://github.com/salesforce/ja3</a>) make a tool to fingerprint systems based on hashing responses to TLS handshakes (options, how it handles things). Turns out, it&rsquo;s good enough to spot weird things like Cobalt Strike servers in the wild with pretty good (ie low false positive) rates. The hashes are fuzzy, meaning you can kind of tell if something is close to something else.</p><p>A really good writeup is at
<a href=https://engineering.salesforce.com/easily-identify-malicious-servers-on-the-internet-with-jarm-e095edac525a>https://engineering.salesforce.com/easily-identify-malicious-servers-on-the-internet-with-jarm-e095edac525a</a></p><p>Probably worth looking into if you&rsquo;re a defensive team and trying to understand more about a server you&rsquo;re clients are communicating with.</p><p>Check it out at <a href=https://github.com/salesforce/jarm>https://github.com/salesforce/jarm</a></p><h2 id=modern-attacks-on-chrome>Modern attacks on Chrome</h2><p>An Azimuth employee gets approval to publish a blog post based on an internal talk, showing you the calibre of their staff.</p><p><a href="https://doar-e.github.io/blog/2020/11/17/modern-attacks-on-the-chrome-browser-optimizations-and-deoptimizations/?s=09">https://doar-e.github.io/blog/2020/11/17/modern-attacks-on-the-chrome-browser-optimizations-and-deoptimizations/?s=09</a></p><h2 id=ticketmaster-tries-project-hell-also-gets-caught>Ticketmaster tries Project Hell, also gets caught</h2><p>(For those who didn&rsquo;t know, Project Hell was Uber&rsquo;s way of fucking with their competitors, Lyft - <a href=https://techcrunch.com/2017/04/12/hell-o-uber/>https://techcrunch.com/2017/04/12/hell-o-uber/</a>)</p><p><a href=https://threatpost.com/ticketmaster-10-million-fine-hacking-rival/162695/>https://threatpost.com/ticketmaster-10-million-fine-hacking-rival/162695/</a></p><p>Turns out you should probably offboard employees properly and revoke their access when they leave, otherwise they&rsquo;ll be stupid enough to re-use them and tell the executives about their accesses, in writing.</p><p>The short edition is as follows:</p><ul><li>Guy works at competitors</li><li>Guy leaves competitors</li><li>Guy joins Ticketmaster</li><li>Guy realises his creds still work for other place</li><li>Guy logs in and uses it to figure out who the competition is working with</li><li>???</li><li>Guy gives it to execs, somehow gets more creds, they presumably use this information for a competitive edge</li></ul><p>The funny highlights out of the case (<a href=https://www.justice.gov/usao-edny/press-release/file/1349741/download>https://www.justice.gov/usao-edny/press-release/file/1349741/download</a> - page 22, &lsquo;Attachment A - Statement of Facts&rsquo;):</p><ul><li>&ldquo;After joining Live Nation, Coconspirator-1 explained to Zaidi and others how the “store ID” numbers in the URLs for the Victim Company’s ticketing web pages were numbered sequentially, enabling TICKETMASTER employees to browse through them to find and monitor new ticketing web pages to learn which artists planned to use the Victim Company to sell tickets for their shows.&rdquo;<ul><li>Sounds like direct object reference</li><li>If they just stuck with bruting these instead of using creds, would they have been breaking CFAA?</li></ul></li><li>" Log data obtained from the Victim Company indicates that the three new Victim Company Toolboxes identified in Coconspirator-1’s email were accessed from an IP address registered to TICKETMASTER’s New York offices on or about June 2, 2014"<ul><li>Don&rsquo;t do crimes from your own IP space</li></ul></li><li>The bad guy emails his executives with the following nuggets:<ul><li>&ldquo;I must stress that as this is access to a live [Victim Company] tool I would be careful in what you click on as it would be best not to giveaway that we are snooping around.&rdquo;</li><li>&ldquo;screen-grab the hell out of the system”</li></ul></li></ul><p>It&rsquo;s unclear how they were caught though, other than their shitty opsec and that his account was attributed directly to him, although it&rsquo;s unclear where the other account credentials came from.</p></div></div><div class="footer wrapper"><nav class=nav><div></div></nav></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-141761824-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>