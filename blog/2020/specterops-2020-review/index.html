<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>SpecterOps training - VRO and Mac Tradecraft review - Pentester, wtf!?</title><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="SpecterOps training - VRO and Mac Tradecraft review"><meta property="og:description" content="Do SpecterOps training, it's good for you (and your team!)"><meta property="og:type" content="article"><meta property="og:url" content="/blog/2020/specterops-2020-review/"><meta property="article:published_time" content="2020-01-01T18:00:00+10:00"><meta property="article:modified_time" content="2020-01-01T18:00:00+10:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="SpecterOps training - VRO and Mac Tradecraft review"><meta name=twitter:description content="Do SpecterOps training, it's good for you (and your team!)"><link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:500,100,300" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=/css/normalize.css><link rel=stylesheet type=text/css media=screen href=/css/main.css></head><body><div class="container wrapper post"><div class=header><a href=/><img src=/images/header.png alt="Break things, write reports"></a><div class=site-description></div><nav class=nav><ul class=flat><li><a href=/>home</a></li><li><a href=/categories/>Categories</a></li><li><a href=/tags/>Tags</a></li></ul></nav></div><div class=post-header><h1 class=title>SpecterOps training - VRO and Mac Tradecraft review</h1><div class=meta>Posted at &mdash; Jan 1, 2020</div></div><div class=markdown><p>I ended up doing two offerings of SpecterOps Adversary tactics training this year, Vulnerability research for operators (VRO), and Mac Tradecraft (<a href=https://specterops.io/how-we-help/training-offerings/adversary-tactics-vulnerability-research-for-operators>https://specterops.io/how-we-help/training-offerings/adversary-tactics-vulnerability-research-for-operators</a> and <a href=https://specterops.io/how-we-help/training-offerings/adversary-tactics-mac-tradecraft),>https://specterops.io/how-we-help/training-offerings/adversary-tactics-mac-tradecraft),</a> which were both pretty good offerings.</p><p>Both offerings ran for two days, and were performed over the week of 16th to 20th of November, running via PST time and done over Zoom.</p><p>Living in AU, this practically turned into waking up at midnight and staying awake until midday to do the training.</p><p>The VRO course covered the following topics:</p><ul><li>SID/ACL/DACLs in Windows</li><li>Token (ab)use</li><li>Integrity levels</li><li>.net serialisation issues / .net remoting</li><li>IPC (Network socket / ALPC/RPC / WCF / Com / DCOM)</li><li>File system bugs</li><li>Path canonicalisation</li><li>Driver vulnerabilities</li></ul><p>I think the big thing for me was going into driver reversing (it&rsquo;s easier than you&rsquo;d think, the binaries end up with a lot less guff to read) and COM abuse. The rest would be fantastic for your up and coming junior-ish staff, and was fairly easy to follow along.</p><p>The Mac Tradecraft was also fairly good, however it showed the state of security for OSX is way behind what it is in windows land, ie:</p><ul><li>Safari Drive-by&rsquo;s look about as bad as the Trusted Zone in IE (see: <a href=https://objective-see.com/blog/blog_0x38.html>https://objective-see.com/blog/blog_0x38.html</a>)</li><li>Transparency Consent and Control (TCC) is the most infuriating thing to use, which ends up moving your computer to a phone and not a general purpose PC</li><li>Users usually have admin anyway, and can run silly stuff</li><li>You don&rsquo;t have COM, instead you have Apple Events</li><li>You can&rsquo;t run portable (You have MachO instead), but you do have scripts in package files (Which people have to run as part of their workflow)</li><li>You also have python, and this AppleScript/Automation framework, which is basically just JavaScript (JXA - JavaScript for Automation)</li><li>Theres a bit more social engineering involved</li></ul><p>You&rsquo;d think an OSX machine should be harder to deal with, but in the end it comes down to slightly more social engineering, and the machines are so annoying that people are going to ignore the 50 pop-ups for TCC, and install/doubleclick/run your payload anyway, as it&rsquo;s just business as usual.</p><p>I didn&rsquo;t see the point of TCC other than to make your computer less of a general purpose PC, and move it towards a Phone and give you less control, however it&rsquo;s only a fairly recent thing (2019?), which will prompt the user if you try to do things like that screenshots, but won&rsquo;t stop you from reading the users ssh private keys or config stored on disk in their home directory. There&rsquo;s also this annoying file system permissions thing, but you can ultimately ignore it if you just SSH to the system.</p><p>Theres a handful of silly mitigations, like how the system will run yara against certain files before you install them, but as it&rsquo;s just yara, pull the XProtect.yara rules file and try your payload before sending it (but you probably won&rsquo;t need to, as the signatures are pretty specific and trashy).</p><p>At worst, pivot to one of these machines, pull the users credentials for every other system then bail, do not sit on one of these silly boxes for too long.</p><p>Both of the courses run really well over Zoom, you remote into a team-based lab using Guacamole, and seem to run fairly well. Our team ended up with some good guys, and with a lot of good time with the specterops staff (we ended up having some cool chats with <a href=https://github.com/cobbr>https://github.com/cobbr</a> and <a href=https://github.com/D00MFist>https://github.com/D00MFist</a> for both courses, as they just hop into your zoom call and say hi.)</p><p>Would recommend the training, but it does make me wonder if organisations are better off with Windows/Azure AD boxes - at least end users don&rsquo;t expect to be able to just run arbitrary crap all the time (Maybe the app packaging options for OSX are bad?), or to run as admin.</p></div></div><div class="footer wrapper"><nav class=nav><div></div></nav></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-141761824-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>